<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rappers</title>
    <style>
        /* (Mantive o CSS anterior para preservar o estilo) */
    </style>
</head>
<body>
    <h1>Rappers</h1>

    <!-- Menu de Critérios -->
    <div class="criteria">
        <h2>Critérios de Avaliação</h2>
        <ul>
            <li><strong>Consistência (1-10):</strong> Avaliação da regularidade do rapper.</li>
            <li><strong>Material (1-10):</strong> Qualidade das rimas e letras.</li>
            <li><strong>Performance (1-10):</strong> Habilidade em palco.</li>
            <li><strong>Adversários (1-10):</strong> Nível dos oponentes enfrentados.</li>
            <li><strong>Impacto (1-10):</strong> Influência no cenário do rap.</li>
            <li><strong>Confronto Direto (1-10):</strong> Desempenho em batalhas diretas.</li>
        </ul>
        <p><strong>Nota sobre Underdog e Favorito:</strong></p>
        <ul>
            <li><strong>Favorito que ganha:</strong> Pontuação total é mantida (sem alteração).</li>
            <li><strong>Favorito que perde:</strong> Pontuação total é <strong>reduzida em 20%</strong>.</li>
            <li><strong>Underdog que ganha:</strong> Pontuação total é <strong>aumentada em 20%</strong>.</li>
            <li><strong>Underdog que perde:</strong> Pontuação total é mantida (sem alteração).</li>
        </ul>
        <p><strong>Nota:</strong> Ao selecionar "Underdog" ou "Favorito", a escolha se aplica ao rapper da coluna, não ao adversário.</p>
    </div>

    <div class="container">
        <!-- Lista de Rappers -->
        <div class="rapper-container">
            <!-- 3ma -->
            <div class="rapper-card" id="3ma">
                <h2>3ma</h2>
                <div class="voting-options">
                    <label for="3ma_consistencia">Consistência (1-10):</label>
                    <input type="number" id="3ma_consistencia" min="1" max="10" required>
                    <label for="3ma_material">Material (1-10):</label>
                    <input type="number" id="3ma_material" min="1" max="10" required>
                    <label for="3ma_performance">Performance (1-10):</label>
                    <input type="number" id="3ma_performance" min="1" max="10" required>
                    <label for="3ma_adversarios">Adversários (1-10):</label>
                    <input type="number" id="3ma_adversarios" min="1" max="10" required>
                    <label for="3ma_impacto">Impacto (1-10):</label>
                    <input type="number" id="3ma_impacto" min="1" max="10" required>
                    <label for="3ma_confronto">Confronto Direto (1-10):</label>
                    <input type="number" id="3ma_confronto" min="1" max="10" required>
                </div>
                <div class="recent-battles">
                    <h3>Batalhas Recentes</h3>
                    <ul>
                        <li>KM
                            <select name="3ma_status" onchange="updateOpponentStatus('3ma', 'KM')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="3ma_result" onchange="updateOpponentResult('3ma', 'KM')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                        <li>Shap3
                            <select name="3ma_status" onchange="updateOpponentStatus('3ma', 'Shap3')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="3ma_result" onchange="updateOpponentResult('3ma', 'Shap3')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                        <li>Lc
                            <select name="3ma_status" onchange="updateOpponentStatus('3ma', 'Lc')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="3ma_result" onchange="updateOpponentResult('3ma', 'Lc')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                    </ul>
                </div>
                <button onclick="submitVote('3ma')">Votar</button>
            </div>

            <!-- Abismal -->
            <div class="rapper-card" id="abismal">
                <h2>Abismal</h2>
                <div class="voting-options">
                    <label for="abismal_consistencia">Consistência (1-10):</label>
                    <input type="number" id="abismal_consistencia" min="1" max="10" required>
                    <label for="abismal_material">Material (1-10):</label>
                    <input type="number" id="abismal_material" min="1" max="10" required>
                    <label for="abismal_performance">Performance (1-10):</label>
                    <input type="number" id="abismal_performance" min="1" max="10" required>
                    <label for="abismal_adversarios">Adversários (1-10):</label>
                    <input type="number" id="abismal_adversarios" min="1" max="10" required>
                    <label for="abismal_impacto">Impacto (1-10):</label>
                    <input type="number" id="abismal_impacto" min="1" max="10" required>
                    <label for="abismal_confronto">Confronto Direto (1-10):</label>
                    <input type="number" id="abismal_confronto" min="1" max="10" required>
                </div>
                <div class="recent-battles">
                    <h3>Batalhas Recentes</h3>
                    <ul>
                        <li>Edi Ventura
                            <select name="abismal_status" onchange="updateOpponentStatus('abismal', 'Edi Ventura')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="abismal_result" onchange="updateOpponentResult('abismal', 'Edi Ventura')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                        <li>Flajo
                            <select name="abismal_status" onchange="updateOpponentStatus('abismal', 'Flajo')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="abismal_result" onchange="updateOpponentResult('abismal', 'Flajo')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                        <li>WilsonG
                            <select name="abismal_status" onchange="updateOpponentStatus('abismal', 'WilsonG')">
                                <option value="favorite">Favorito</option>
                                <option value="underdog">Underdog</option>
                            </select>
                            <select name="abismal_result" onchange="updateOpponentResult('abismal', 'WilsonG')">
                                <option value="vitoria">Vitória</option>
                                <option value="derrota">Derrota</option>
                            </select>
                        </li>
                    </ul>
                </div>
                <button onclick="submitVote('abismal')">Votar</button>
            </div>

            <!-- Adicione mais rappers aqui -->
        </div>

        <!-- Tabela de Pontuação Geral -->
        <div class="scoreboard">
            <h2>Pontuação Geral</h2>
            <table>
                <thead>
                    <tr>
                        <th>Rapper</th>
                        <th>Pontuação</th>
                    </tr>
                </thead>
                <tbody id="scoreboard-body">
                    <!-- As pontuações serão preenchidas dinamicamente via JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Função para atualizar o status do oponente
        function updateOpponentStatus(rapperId, opponentId) {
            const status = document.querySelector(`select[name="${rapperId}_status"]`).value;
            const opponentStatus = document.querySelector(`select[name="${opponentId}_status"]`);

            if (status === "favorite") {
                opponentStatus.value = "underdog";
            } else if (status === "underdog") {
                opponentStatus.value = "favorite";
            }
        }

        // Função para atualizar o resultado do oponente
        function updateOpponentResult(rapperId, opponentId) {
            const result = document.querySelector(`select[name="${rapperId}_result"]`).value;
            const opponentResult = document.querySelector(`select[name="${opponentId}_result"]`);

            if (result === "vitoria") {
                opponentResult.value = "derrota";
            } else if (result === "derrota") {
                opponentResult.value = "vitoria";
            }
        }

        // Função para salvar os votos no localStorage
        function submitVote(rapperId) {
            const consistencia = parseFloat(document.getElementById(`${rapperId}_consistencia`).value);
            const material = parseFloat(document.getElementById(`${rapperId}_material`).value);
            const performance = parseFloat(document.getElementById(`${rapperId}_performance`).value);
            const adversarios = parseFloat(document.getElementById(`${rapperId}_adversarios`).value);
            const impacto = parseFloat(document.getElementById(`${rapperId}_impacto`).value);
            const confronto = parseFloat(document.getElementById(`${rapperId}_confronto`).value);

            const totalScore = consistencia + material + performance + adversarios + impacto + confronto;

            // Verifica se é Underdog ou Favorito e o resultado da batalha
            const status = document.querySelector(`select[name="${rapperId}_status"]`).value;
            const result = document.querySelector(`select[name="${rapperId}_result"]`).value;

            let finalScore = totalScore;

            if (status === "favorite" && result === "derrota") {
                // Favorito que perde: perde 20% da pontuação
                finalScore *= 0.8;
            } else if (status === "underdog" && result === "vitoria") {
                // Underdog que ganha: ganha 20% de bônus
                finalScore *= 1.2;
            }

            // Salva a pontuação no localStorage
            localStorage.setItem(rapperId, finalScore);

            // Atualiza a tabela de pontuação
            updateScoreboard();
        }

        // Função para atualizar a tabela de pontuação
        function updateScoreboard() {
            const scoreboardBody = document.getElementById('scoreboard-body');
            scoreboardBody.innerHTML = '';

            // Recupera todos os rappers e suas pontuações
            const rappers = ['3ma', 'abismal']; // Adicione mais rappers aqui
            rappers.forEach(rapper => {
                const score = parseFloat(localStorage.getItem(rapper)) || 0;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${rapper}</td>
                    <td>${score.toFixed(1)}</td>
                `;
                scoreboardBody.appendChild(row);
            });
        }

        // Atualiza a tabela de pontuação ao carregar a página
        window.onload = updateScoreboard;
    </script>
</body>
</html>
